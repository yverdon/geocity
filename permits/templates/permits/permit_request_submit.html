{% extends "base_generic.html" %}
{% load bootstrap4 %}
{% load i18n %}
{% load permits_extras %}

{% block content %}
  {% permit_progressbar steps StepType.SUBMIT %}
  <h3>{% trans "Résumé et envoi" %}</h3>
  <hr>
  {% if incomplete_steps  %}
  <p>
    {% blocktrans trimmed %}
      Votre demande n'est pas complète mais elle est sauvegardée. Vous pouvez
      revenir dans l'application ultérieurement afin de la compléter. Une fois
      toutes les informations saisies, vous pourrez l'envoyer.
    {% endblocktrans %}
  </p>
  {% endif %}
  <p>
    {% trans "Vous trouverez ci-dessous un récapitulatif de votre demande." %}
  </p>

  {% permit_request_summary permit_request %}

  <form method="post">
    {% csrf_token %}
    {% buttons %}
    {% if incomplete_steps %}
      <a class="btn btn-primary" href="{{ incomplete_steps|first }}">{% trans "Renseigner les informations manquantes" %}</a>
    {% else %}
      {% if permit_request.administrative_entity.legal_document %}
        <div id="legal-infos">
          <h5>Merci de prendre connaissance des directives ci-dessous</h5>
          <p>
            <b>Directives</b>
              <a href="{{permit_request.administrative_entity.legal_document.url}}" target="_blank">{% trans 'Télécharger le PDF' %}</a>
          </p>
            <b>Autres informations</b><br>
            {{ permit_request.administrative_entity.general_informations }}
        </div>
        <hr>
      {% endif %}
      {% if previous_step.url %}
        <a href="{{ previous_step.url }}" class="mr-2">{% trans "Retour" %}</a>
      {% endif %}
      <a class="btn btn-primary" href="{% url 'permits:permit_request_submit_confirmed' permit_request_id=permit_request.pk %}" class="mr-2">
      {% trans "Envoyer" %}</a>
    {% endif %}
    {% endbuttons %}
  </form>
<br><br>
{% endblock %}
