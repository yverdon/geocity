{% load i18n %}
{% load submissions_extras %}

{% can_revert_refund_transaction as can_revert_refund %}
{% can_refund_transaction as can_refund %}

{% if can_revert_refund or can_refund %}
  {% if record.status != 'failed' and record.can_have_status_changed %}
      <ul class="list-inline text-left">
        <li>
          <div class="form-group">
            <select class="form-control transactionStatusChangeSelect" id="transactionStatusChangeSelect-{{ record.transaction_id }}">
              <option value="">--------</option>
              {% if can_refund %}
                {% if record.status != 'to_refund' and record.status != 'refunded' and record.status != 'failed' %}
                  <option value="to_refund">{% translate "A rembourser" %}</option>
                {% endif %}
                {% if record.status != 'refunded' and record.status != 'failed' %}
                  <option value="refunded">{% translate "RemboursÃ©e" %}</option>
                {% endif %}
              {% endif %}
              {% if can_revert_refund and record.status != 'paid' and record.status != 'failed' %}
                <option value="paid">{% translate "PayÃ©e" %}</option>
              {% endif %}
            </select>
          </div>
        </li>
        <li>
            <button class="btn btn-primary transactionStatusChangeBtn" data-href="{% url 'submissions:change_transaction_status' record.transaction_id %}" data-merchant-reference="{{ record.transaction_id }}">
              <i class="fa fa-save" style="pointer-events: none"></i>
            </button>
        </li>
      </ul>
    {% endif %}
{% endif %}
